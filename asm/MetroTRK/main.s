.include "macros.inc"

.section .text, "ax"

glabel gdev_cc_initinterrupts
/* 80173C70 0016F190  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80173C74 0016F194  7C 08 02 A6 */	mflr r0
/* 80173C78 0016F198  90 01 00 14 */	stw r0, 0x14(r1)
/* 80173C7C 0016F19C  4B F1 38 21 */	bl DBInitInterrupts
/* 80173C80 0016F1A0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80173C84 0016F1A4  38 60 00 00 */	li r3, 0
/* 80173C88 0016F1A8  7C 08 03 A6 */	mtlr r0
/* 80173C8C 0016F1AC  38 21 00 10 */	addi r1, r1, 0x10
/* 80173C90 0016F1B0  4E 80 00 20 */	blr 

glabel gdev_cc_peek
/* 80173C94 0016F1B4  94 21 FA F0 */	stwu r1, -0x510(r1)
/* 80173C98 0016F1B8  7C 08 02 A6 */	mflr r0
/* 80173C9C 0016F1BC  90 01 05 14 */	stw r0, 0x514(r1)
/* 80173CA0 0016F1C0  93 E1 05 0C */	stw r31, 0x50c(r1)
/* 80173CA4 0016F1C4  4B F1 38 4D */	bl DBQueryData
/* 80173CA8 0016F1C8  7C 7F 1B 79 */	or. r31, r3, r3
/* 80173CAC 0016F1CC  41 81 00 0C */	bgt lbl_80173CB8
/* 80173CB0 0016F1D0  38 60 00 00 */	li r3, 0
/* 80173CB4 0016F1D4  48 00 00 3C */	b lbl_80173CF0
lbl_80173CB8:
/* 80173CB8 0016F1D8  7F E4 FB 78 */	mr r4, r31
/* 80173CBC 0016F1DC  38 61 00 08 */	addi r3, r1, 8
/* 80173CC0 0016F1E0  4B F1 38 D5 */	bl DBRead
/* 80173CC4 0016F1E4  2C 03 00 00 */	cmpwi r3, 0
/* 80173CC8 0016F1E8  40 82 00 1C */	bne lbl_80173CE4
/* 80173CCC 0016F1EC  3C 60 80 24 */	lis r3, lbl_80246460@ha
/* 80173CD0 0016F1F0  7F E5 FB 78 */	mr r5, r31
/* 80173CD4 0016F1F4  38 63 64 60 */	addi r3, r3, lbl_80246460@l
/* 80173CD8 0016F1F8  38 81 00 08 */	addi r4, r1, 8
/* 80173CDC 0016F1FC  48 00 03 5D */	bl CircleBufferWriteBytes
/* 80173CE0 0016F200  48 00 00 0C */	b lbl_80173CEC
lbl_80173CE4:
/* 80173CE4 0016F204  38 60 D8 E7 */	li r3, -10009
/* 80173CE8 0016F208  48 00 00 08 */	b lbl_80173CF0
lbl_80173CEC:
/* 80173CEC 0016F20C  7F E3 FB 78 */	mr r3, r31
lbl_80173CF0:
/* 80173CF0 0016F210  80 01 05 14 */	lwz r0, 0x514(r1)
/* 80173CF4 0016F214  83 E1 05 0C */	lwz r31, 0x50c(r1)
/* 80173CF8 0016F218  7C 08 03 A6 */	mtlr r0
/* 80173CFC 0016F21C  38 21 05 10 */	addi r1, r1, 0x510
/* 80173D00 0016F220  4E 80 00 20 */	blr 

glabel gdev_cc_post_stop
/* 80173D04 0016F224  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80173D08 0016F228  7C 08 02 A6 */	mflr r0
/* 80173D0C 0016F22C  90 01 00 14 */	stw r0, 0x14(r1)
/* 80173D10 0016F230  4B F1 3A 15 */	bl DBOpen
/* 80173D14 0016F234  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80173D18 0016F238  38 60 00 00 */	li r3, 0
/* 80173D1C 0016F23C  7C 08 03 A6 */	mtlr r0
/* 80173D20 0016F240  38 21 00 10 */	addi r1, r1, 0x10
/* 80173D24 0016F244  4E 80 00 20 */	blr 

glabel gdev_cc_pre_continue
/* 80173D28 0016F248  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80173D2C 0016F24C  7C 08 02 A6 */	mflr r0
/* 80173D30 0016F250  90 01 00 14 */	stw r0, 0x14(r1)
/* 80173D34 0016F254  4B F1 39 F5 */	bl DBClose
/* 80173D38 0016F258  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80173D3C 0016F25C  38 60 00 00 */	li r3, 0
/* 80173D40 0016F260  7C 08 03 A6 */	mtlr r0
/* 80173D44 0016F264  38 21 00 10 */	addi r1, r1, 0x10
/* 80173D48 0016F268  4E 80 00 20 */	blr 

glabel gdev_cc_write
/* 80173D4C 0016F26C  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80173D50 0016F270  7C 08 02 A6 */	mflr r0
/* 80173D54 0016F274  90 01 00 14 */	stw r0, 0x14(r1)
/* 80173D58 0016F278  93 E1 00 0C */	stw r31, 0xc(r1)
/* 80173D5C 0016F27C  7C 9F 23 78 */	mr r31, r4
/* 80173D60 0016F280  93 C1 00 08 */	stw r30, 8(r1)
/* 80173D64 0016F284  7C 7E 1B 78 */	mr r30, r3
/* 80173D68 0016F288  80 0D 93 70 */	lwz r0, lbl_802477F0@sda21(r13)
/* 80173D6C 0016F28C  2C 00 00 00 */	cmpwi r0, 0
/* 80173D70 0016F290  40 82 00 2C */	bne lbl_80173D9C
/* 80173D74 0016F294  38 60 D8 EF */	li r3, -10001
/* 80173D78 0016F298  48 00 00 30 */	b lbl_80173DA8
/* 80173D7C 0016F29C  48 00 00 20 */	b lbl_80173D9C
lbl_80173D80:
/* 80173D80 0016F2A0  7F C3 F3 78 */	mr r3, r30
/* 80173D84 0016F2A4  7F E4 FB 78 */	mr r4, r31
/* 80173D88 0016F2A8  4B F1 38 8D */	bl DBWrite
/* 80173D8C 0016F2AC  2C 03 00 00 */	cmpwi r3, 0
/* 80173D90 0016F2B0  41 82 00 14 */	beq lbl_80173DA4
/* 80173D94 0016F2B4  7F DE 1A 14 */	add r30, r30, r3
/* 80173D98 0016F2B8  7F E3 F8 50 */	subf r31, r3, r31
lbl_80173D9C:
/* 80173D9C 0016F2BC  2C 1F 00 00 */	cmpwi r31, 0
/* 80173DA0 0016F2C0  41 81 FF E0 */	bgt lbl_80173D80
lbl_80173DA4:
/* 80173DA4 0016F2C4  38 60 00 00 */	li r3, 0
lbl_80173DA8:
/* 80173DA8 0016F2C8  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80173DAC 0016F2CC  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 80173DB0 0016F2D0  83 C1 00 08 */	lwz r30, 8(r1)
/* 80173DB4 0016F2D4  7C 08 03 A6 */	mtlr r0
/* 80173DB8 0016F2D8  38 21 00 10 */	addi r1, r1, 0x10
/* 80173DBC 0016F2DC  4E 80 00 20 */	blr 

glabel gdev_cc_read
/* 80173DC0 0016F2E0  94 21 FA E0 */	stwu r1, -0x520(r1)
/* 80173DC4 0016F2E4  7C 08 02 A6 */	mflr r0
/* 80173DC8 0016F2E8  90 01 05 24 */	stw r0, 0x524(r1)
/* 80173DCC 0016F2EC  BF 61 05 0C */	stmw r27, 0x50c(r1)
/* 80173DD0 0016F2F0  7C 7B 1B 78 */	mr r27, r3
/* 80173DD4 0016F2F4  3B A0 00 00 */	li r29, 0
/* 80173DD8 0016F2F8  80 0D 93 70 */	lwz r0, lbl_802477F0@sda21(r13)
/* 80173DDC 0016F2FC  2C 00 00 00 */	cmpwi r0, 0
/* 80173DE0 0016F300  40 82 00 0C */	bne lbl_80173DEC
/* 80173DE4 0016F304  38 60 D8 EF */	li r3, -10001
/* 80173DE8 0016F308  48 00 00 78 */	b lbl_80173E60
lbl_80173DEC:
/* 80173DEC 0016F30C  3C 60 80 24 */	lis r3, lbl_80246460@ha
/* 80173DF0 0016F310  7C 9E 23 78 */	mr r30, r4
/* 80173DF4 0016F314  3B E3 64 60 */	addi r31, r3, lbl_80246460@l
/* 80173DF8 0016F318  48 00 00 38 */	b lbl_80173E30
lbl_80173DFC:
/* 80173DFC 0016F31C  3B A0 00 00 */	li r29, 0
/* 80173E00 0016F320  4B F1 36 F1 */	bl DBQueryData
/* 80173E04 0016F324  7C 7C 1B 79 */	or. r28, r3, r3
/* 80173E08 0016F328  41 82 00 28 */	beq lbl_80173E30
/* 80173E0C 0016F32C  7F C4 F3 78 */	mr r4, r30
/* 80173E10 0016F330  38 61 00 08 */	addi r3, r1, 8
/* 80173E14 0016F334  4B F1 37 81 */	bl DBRead
/* 80173E18 0016F338  7C 7D 1B 79 */	or. r29, r3, r3
/* 80173E1C 0016F33C  40 82 00 14 */	bne lbl_80173E30
/* 80173E20 0016F340  7F E3 FB 78 */	mr r3, r31
/* 80173E24 0016F344  7F 85 E3 78 */	mr r5, r28
/* 80173E28 0016F348  38 81 00 08 */	addi r4, r1, 8
/* 80173E2C 0016F34C  48 00 02 0D */	bl CircleBufferWriteBytes
lbl_80173E30:
/* 80173E30 0016F350  7F E3 FB 78 */	mr r3, r31
/* 80173E34 0016F354  48 00 03 5D */	bl CBGetBytesAvailableForRead
/* 80173E38 0016F358  7C 03 F0 40 */	cmplw r3, r30
/* 80173E3C 0016F35C  41 80 FF C0 */	blt lbl_80173DFC
/* 80173E40 0016F360  28 1D 00 00 */	cmplwi r29, 0
/* 80173E44 0016F364  40 82 00 18 */	bne lbl_80173E5C
/* 80173E48 0016F368  3C 60 80 24 */	lis r3, lbl_80246460@ha
/* 80173E4C 0016F36C  7F 64 DB 78 */	mr r4, r27
/* 80173E50 0016F370  38 63 64 60 */	addi r3, r3, lbl_80246460@l
/* 80173E54 0016F374  7F C5 F3 78 */	mr r5, r30
/* 80173E58 0016F378  48 00 00 D9 */	bl CircleBufferReadBytes
lbl_80173E5C:
/* 80173E5C 0016F37C  7F A3 EB 78 */	mr r3, r29
lbl_80173E60:
/* 80173E60 0016F380  BB 61 05 0C */	lmw r27, 0x50c(r1)
/* 80173E64 0016F384  80 01 05 24 */	lwz r0, 0x524(r1)
/* 80173E68 0016F388  7C 08 03 A6 */	mtlr r0
/* 80173E6C 0016F38C  38 21 05 20 */	addi r1, r1, 0x520
/* 80173E70 0016F390  4E 80 00 20 */	blr 

glabel gdev_cc_close
/* 80173E74 0016F394  38 60 00 00 */	li r3, 0
/* 80173E78 0016F398  4E 80 00 20 */	blr 

glabel gdev_cc_open
/* 80173E7C 0016F39C  80 0D 93 70 */	lwz r0, lbl_802477F0@sda21(r13)
/* 80173E80 0016F3A0  2C 00 00 00 */	cmpwi r0, 0
/* 80173E84 0016F3A4  41 82 00 0C */	beq lbl_80173E90
/* 80173E88 0016F3A8  38 60 D8 EB */	li r3, -10005
/* 80173E8C 0016F3AC  4E 80 00 20 */	blr 
lbl_80173E90:
/* 80173E90 0016F3B0  38 00 00 01 */	li r0, 1
/* 80173E94 0016F3B4  38 60 00 00 */	li r3, 0
/* 80173E98 0016F3B8  90 0D 93 70 */	stw r0, lbl_802477F0@sda21(r13)
/* 80173E9C 0016F3BC  4E 80 00 20 */	blr 

glabel gdev_cc_shutdown
/* 80173EA0 0016F3C0  38 60 00 00 */	li r3, 0
/* 80173EA4 0016F3C4  4E 80 00 20 */	blr 

glabel gdev_cc_initialize
/* 80173EA8 0016F3C8  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80173EAC 0016F3CC  7C 08 02 A6 */	mflr r0
/* 80173EB0 0016F3D0  90 01 00 14 */	stw r0, 0x14(r1)
/* 80173EB4 0016F3D4  4B F1 35 8D */	bl DBInitComm
/* 80173EB8 0016F3D8  3C 60 80 24 */	lis r3, lbl_80246460@ha
/* 80173EBC 0016F3DC  3C 80 80 24 */	lis r4, lbl_80245F60@ha
/* 80173EC0 0016F3E0  38 63 64 60 */	addi r3, r3, lbl_80246460@l
/* 80173EC4 0016F3E4  38 A0 05 00 */	li r5, 0x500
/* 80173EC8 0016F3E8  38 84 5F 60 */	addi r4, r4, lbl_80245F60@l
/* 80173ECC 0016F3EC  48 00 02 75 */	bl CircleBufferInitialize
/* 80173ED0 0016F3F0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80173ED4 0016F3F4  38 60 00 00 */	li r3, 0
/* 80173ED8 0016F3F8  7C 08 03 A6 */	mtlr r0
/* 80173EDC 0016F3FC  38 21 00 10 */	addi r1, r1, 0x10
/* 80173EE0 0016F400  4E 80 00 20 */	blr 

glabel OutputData
/* 80173EE4 0016F404  2C 04 00 00 */	cmpwi r4, 0
/* 80173EE8 0016F408  38 A0 00 00 */	li r5, 0
/* 80173EEC 0016F40C  4C 81 00 20 */	blelr 
/* 80173EF0 0016F410  2C 04 00 08 */	cmpwi r4, 8
/* 80173EF4 0016F414  38 64 FF F8 */	addi r3, r4, -8
/* 80173EF8 0016F418  40 81 00 20 */	ble lbl_80173F18
/* 80173EFC 0016F41C  38 03 00 07 */	addi r0, r3, 7
/* 80173F00 0016F420  54 00 E8 FE */	srwi r0, r0, 3
/* 80173F04 0016F424  7C 09 03 A6 */	mtctr r0
/* 80173F08 0016F428  2C 03 00 00 */	cmpwi r3, 0
/* 80173F0C 0016F42C  40 81 00 0C */	ble lbl_80173F18
lbl_80173F10:
/* 80173F10 0016F430  38 A5 00 08 */	addi r5, r5, 8
/* 80173F14 0016F434  42 00 FF FC */	bdnz lbl_80173F10
lbl_80173F18:
/* 80173F18 0016F438  7C 05 20 50 */	subf r0, r5, r4
/* 80173F1C 0016F43C  7C 09 03 A6 */	mtctr r0
/* 80173F20 0016F440  7C 05 20 00 */	cmpw r5, r4
/* 80173F24 0016F444  4C 80 00 20 */	bgelr 
lbl_80173F28:
/* 80173F28 0016F448  42 00 00 00 */	bdnz lbl_80173F28
/* 80173F2C 0016F44C  4E 80 00 20 */	blr 

.section .bss, "wa"  # 0x801ADFC0 - 0x80246480

glabel lbl_80245F60
	.skip 0x500

glabel lbl_80246460
	.skip 0x1C


.section .sbss, "wa" # 0x80246B60 - 0x80247800

glabel lbl_802477F0
	.skip 0x4