.include "macros.inc"

.section .text, "ax"

glabel TRKTerminateSerialHandler
/* 8016F7C0 0016ACE0  38 60 00 00 */	li r3, 0
/* 8016F7C4 0016ACE4  4E 80 00 20 */	blr 

glabel TRKInitializeSerialHandler
/* 8016F7C8 0016ACE8  3C 60 80 24 */	lis r3, lbl_802459A0@ha
/* 8016F7CC 0016ACEC  38 A0 FF FF */	li r5, -1
/* 8016F7D0 0016ACF0  38 83 59 A0 */	addi r4, r3, lbl_802459A0@l
/* 8016F7D4 0016ACF4  38 00 00 00 */	li r0, 0
/* 8016F7D8 0016ACF8  90 A4 00 00 */	stw r5, 0(r4)
/* 8016F7DC 0016ACFC  38 60 00 00 */	li r3, 0
/* 8016F7E0 0016AD00  90 04 00 08 */	stw r0, 8(r4)
/* 8016F7E4 0016AD04  90 04 00 0C */	stw r0, 0xc(r4)
/* 8016F7E8 0016AD08  4E 80 00 20 */	blr 

glabel TRKProcessInput
/* 8016F7EC 0016AD0C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8016F7F0 0016AD10  7C 08 02 A6 */	mflr r0
/* 8016F7F4 0016AD14  38 80 00 02 */	li r4, 2
/* 8016F7F8 0016AD18  90 01 00 24 */	stw r0, 0x24(r1)
/* 8016F7FC 0016AD1C  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8016F800 0016AD20  7C 7F 1B 78 */	mr r31, r3
/* 8016F804 0016AD24  38 61 00 08 */	addi r3, r1, 8
/* 8016F808 0016AD28  4B FF F3 C9 */	bl TRKConstructEvent
/* 8016F80C 0016AD2C  3C 60 80 24 */	lis r3, lbl_802459A0@ha
/* 8016F810 0016AD30  38 00 FF FF */	li r0, -1
/* 8016F814 0016AD34  38 83 59 A0 */	addi r4, r3, lbl_802459A0@l
/* 8016F818 0016AD38  93 E1 00 10 */	stw r31, 0x10(r1)
/* 8016F81C 0016AD3C  38 61 00 08 */	addi r3, r1, 8
/* 8016F820 0016AD40  90 04 00 00 */	stw r0, 0(r4)
/* 8016F824 0016AD44  4B FF F3 C5 */	bl TRKPostEvent
/* 8016F828 0016AD48  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8016F82C 0016AD4C  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8016F830 0016AD50  7C 08 03 A6 */	mtlr r0
/* 8016F834 0016AD54  38 21 00 20 */	addi r1, r1, 0x20
/* 8016F838 0016AD58  4E 80 00 20 */	blr 

glabel TRKGetInput
/* 8016F83C 0016AD5C  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 8016F840 0016AD60  7C 08 02 A6 */	mflr r0
/* 8016F844 0016AD64  90 01 00 24 */	stw r0, 0x24(r1)
/* 8016F848 0016AD68  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 8016F84C 0016AD6C  48 00 00 51 */	bl TRKTestForPacket
/* 8016F850 0016AD70  7C 7F 1B 78 */	mr r31, r3
/* 8016F854 0016AD74  2C 1F FF FF */	cmpwi r31, -1
/* 8016F858 0016AD78  41 82 00 30 */	beq lbl_8016F888
/* 8016F85C 0016AD7C  4B FF FD FD */	bl TRKGetBuffer
/* 8016F860 0016AD80  38 61 00 08 */	addi r3, r1, 8
/* 8016F864 0016AD84  38 80 00 02 */	li r4, 2
/* 8016F868 0016AD88  4B FF F3 69 */	bl TRKConstructEvent
/* 8016F86C 0016AD8C  3C 60 80 24 */	lis r3, lbl_802459A0@ha
/* 8016F870 0016AD90  38 00 FF FF */	li r0, -1
/* 8016F874 0016AD94  38 83 59 A0 */	addi r4, r3, lbl_802459A0@l
/* 8016F878 0016AD98  93 E1 00 10 */	stw r31, 0x10(r1)
/* 8016F87C 0016AD9C  38 61 00 08 */	addi r3, r1, 8
/* 8016F880 0016ADA0  90 04 00 00 */	stw r0, 0(r4)
/* 8016F884 0016ADA4  4B FF F3 65 */	bl TRKPostEvent
lbl_8016F888:
/* 8016F888 0016ADA8  80 01 00 24 */	lwz r0, 0x24(r1)
/* 8016F88C 0016ADAC  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 8016F890 0016ADB0  7C 08 03 A6 */	mtlr r0
/* 8016F894 0016ADB4  38 21 00 20 */	addi r1, r1, 0x20
/* 8016F898 0016ADB8  4E 80 00 20 */	blr 

glabel TRKTestForPacket
/* 8016F89C 0016ADBC  94 21 F7 20 */	stwu r1, -0x8e0(r1)
/* 8016F8A0 0016ADC0  7C 08 02 A6 */	mflr r0
/* 8016F8A4 0016ADC4  90 01 08 E4 */	stw r0, 0x8e4(r1)
/* 8016F8A8 0016ADC8  93 E1 08 DC */	stw r31, 0x8dc(r1)
/* 8016F8AC 0016ADCC  48 00 40 59 */	bl TRKPollUART
/* 8016F8B0 0016ADD0  2C 03 00 00 */	cmpwi r3, 0
/* 8016F8B4 0016ADD4  41 81 00 0C */	bgt lbl_8016F8C0
/* 8016F8B8 0016ADD8  38 60 FF FF */	li r3, -1
/* 8016F8BC 0016ADDC  48 00 00 9C */	b lbl_8016F958
lbl_8016F8C0:
/* 8016F8C0 0016ADE0  38 61 00 0C */	addi r3, r1, 0xc
/* 8016F8C4 0016ADE4  38 81 00 08 */	addi r4, r1, 8
/* 8016F8C8 0016ADE8  4B FF FD BD */	bl TRKGetFreeBuffer
/* 8016F8CC 0016ADEC  7C 60 1B 78 */	mr r0, r3
/* 8016F8D0 0016ADF0  80 61 00 08 */	lwz r3, 8(r1)
/* 8016F8D4 0016ADF4  7C 1F 03 78 */	mr r31, r0
/* 8016F8D8 0016ADF8  38 80 00 00 */	li r4, 0
/* 8016F8DC 0016ADFC  4B FF FC A9 */	bl TRKSetBufferPosition
/* 8016F8E0 0016AE00  38 61 00 10 */	addi r3, r1, 0x10
/* 8016F8E4 0016AE04  38 80 00 40 */	li r4, 0x40
/* 8016F8E8 0016AE08  48 00 3F E1 */	bl TRKReadUARTN
/* 8016F8EC 0016AE0C  2C 03 00 00 */	cmpwi r3, 0
/* 8016F8F0 0016AE10  40 82 00 58 */	bne lbl_8016F948
/* 8016F8F4 0016AE14  80 61 00 08 */	lwz r3, 8(r1)
/* 8016F8F8 0016AE18  38 81 00 10 */	addi r4, r1, 0x10
/* 8016F8FC 0016AE1C  38 A0 00 40 */	li r5, 0x40
/* 8016F900 0016AE20  4B FF F9 F1 */	bl TRKAppendBuffer_ui8
/* 8016F904 0016AE24  80 61 00 10 */	lwz r3, 0x10(r1)
/* 8016F908 0016AE28  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 8016F90C 0016AE2C  34 83 FF C0 */	addic. r4, r3, -64
/* 8016F910 0016AE30  40 81 00 44 */	ble lbl_8016F954
/* 8016F914 0016AE34  38 61 00 50 */	addi r3, r1, 0x50
/* 8016F918 0016AE38  48 00 3F B1 */	bl TRKReadUARTN
/* 8016F91C 0016AE3C  2C 03 00 00 */	cmpwi r3, 0
/* 8016F920 0016AE40  40 82 00 18 */	bne lbl_8016F938
/* 8016F924 0016AE44  80 61 00 08 */	lwz r3, 8(r1)
/* 8016F928 0016AE48  38 81 00 50 */	addi r4, r1, 0x50
/* 8016F92C 0016AE4C  80 A1 00 10 */	lwz r5, 0x10(r1)
/* 8016F930 0016AE50  4B FF F9 C1 */	bl TRKAppendBuffer_ui8
/* 8016F934 0016AE54  48 00 00 20 */	b lbl_8016F954
lbl_8016F938:
/* 8016F938 0016AE58  7F E3 FB 78 */	mr r3, r31
/* 8016F93C 0016AE5C  4B FF FC B9 */	bl TRKReleaseBuffer
/* 8016F940 0016AE60  3B E0 FF FF */	li r31, -1
/* 8016F944 0016AE64  48 00 00 10 */	b lbl_8016F954
lbl_8016F948:
/* 8016F948 0016AE68  7F E3 FB 78 */	mr r3, r31
/* 8016F94C 0016AE6C  4B FF FC A9 */	bl TRKReleaseBuffer
/* 8016F950 0016AE70  3B E0 FF FF */	li r31, -1
lbl_8016F954:
/* 8016F954 0016AE74  7F E3 FB 78 */	mr r3, r31
lbl_8016F958:
/* 8016F958 0016AE78  80 01 08 E4 */	lwz r0, 0x8e4(r1)
/* 8016F95C 0016AE7C  83 E1 08 DC */	lwz r31, 0x8dc(r1)
/* 8016F960 0016AE80  7C 08 03 A6 */	mtlr r0
/* 8016F964 0016AE84  38 21 08 E0 */	addi r1, r1, 0x8e0
/* 8016F968 0016AE88  4E 80 00 20 */	blr 
