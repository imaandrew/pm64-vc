.include "macros.inc"

.section .text, "ax"

glabel __DBMtrHandler
/* 800873F8 00082918  81 8D 89 18 */	lwz r12, lbl_80246D98@sda21(r13)
/* 800873FC 0008291C  38 00 00 01 */	li r0, 1
/* 80087400 00082920  98 0D 89 20 */	stb r0, lbl_80246DA0@sda21(r13)
/* 80087404 00082924  2C 0C 00 00 */	cmpwi r12, 0
/* 80087408 00082928  4D 82 00 20 */	beqlr 
/* 8008740C 0008292C  38 60 00 00 */	li r3, 0
/* 80087410 00082930  7D 89 03 A6 */	mtctr r12
/* 80087414 00082934  4E 80 04 20 */	bctr 
/* 80087418 00082938  4E 80 00 20 */	blr 

glabel __DBIntrHandler
/* 8008741C 0008293C  38 00 10 00 */	li r0, 0x1000
/* 80087420 00082940  3C A0 CC 00 */	lis r5, 0xCC003000@ha
/* 80087424 00082944  90 05 30 00 */	stw r0, 0xCC003000@l(r5)
/* 80087428 00082948  81 8D 89 1C */	lwz r12, lbl_80246D9C@sda21(r13)
/* 8008742C 0008294C  2C 0C 00 00 */	cmpwi r12, 0
/* 80087430 00082950  4D 82 00 20 */	beqlr 
/* 80087434 00082954  7D 89 03 A6 */	mtctr r12
/* 80087438 00082958  4E 80 04 20 */	bctr 
/* 8008743C 0008295C  4E 80 00 20 */	blr 

glabel DBInitComm
/* 80087440 00082960  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 80087444 00082964  7C 08 02 A6 */	mflr r0
/* 80087448 00082968  90 01 00 24 */	stw r0, 0x24(r1)
/* 8008744C 0008296C  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80087450 00082970  93 C1 00 18 */	stw r30, 0x18(r1)
/* 80087454 00082974  7C 9E 23 78 */	mr r30, r4
/* 80087458 00082978  93 A1 00 14 */	stw r29, 0x14(r1)
/* 8008745C 0008297C  7C 7D 1B 78 */	mr r29, r3
/* 80087460 00082980  48 00 DE 55 */	bl OSDisableInterrupts
/* 80087464 00082984  38 0D 89 20 */	addi r0, r13, lbl_80246DA0@sda21
/* 80087468 00082988  7C 7F 1B 78 */	mr r31, r3
/* 8008746C 0008298C  90 1D 00 00 */	stw r0, 0(r29)
/* 80087470 00082990  93 CD 89 18 */	stw r30, lbl_80246D98@sda21(r13)
/* 80087474 00082994  48 00 05 A1 */	bl __DBEXIInit
/* 80087478 00082998  7F E3 FB 78 */	mr r3, r31
/* 8008747C 0008299C  48 00 DE 61 */	bl OSRestoreInterrupts
/* 80087480 000829A0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80087484 000829A4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80087488 000829A8  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 8008748C 000829AC  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 80087490 000829B0  7C 08 03 A6 */	mtlr r0
/* 80087494 000829B4  38 21 00 20 */	addi r1, r1, 0x20
/* 80087498 000829B8  4E 80 00 20 */	blr 

glabel DBInitInterrupts
/* 8008749C 000829BC  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 800874A0 000829C0  7C 08 02 A6 */	mflr r0
/* 800874A4 000829C4  3C 60 00 02 */	lis r3, 0x00018000@ha
/* 800874A8 000829C8  90 01 00 14 */	stw r0, 0x14(r1)
/* 800874AC 000829CC  38 63 80 00 */	addi r3, r3, 0x00018000@l
/* 800874B0 000829D0  48 00 E1 95 */	bl __OSMaskInterrupts
/* 800874B4 000829D4  38 60 00 40 */	li r3, 0x40
/* 800874B8 000829D8  48 00 E1 8D */	bl __OSMaskInterrupts
/* 800874BC 000829DC  3C 60 80 08 */	lis r3, __DBMtrHandler@ha
/* 800874C0 000829E0  3C 80 80 08 */	lis r4, __DBIntrHandler@ha
/* 800874C4 000829E4  38 63 73 F8 */	addi r3, r3, __DBMtrHandler@l
/* 800874C8 000829E8  90 6D 89 1C */	stw r3, lbl_80246D9C@sda21(r13)
/* 800874CC 000829EC  38 84 74 1C */	addi r4, r4, __DBIntrHandler@l
/* 800874D0 000829F0  38 60 00 19 */	li r3, 0x19
/* 800874D4 000829F4  48 00 DE 2D */	bl __OSSetInterruptHandler
/* 800874D8 000829F8  38 60 00 40 */	li r3, 0x40
/* 800874DC 000829FC  48 00 E1 E9 */	bl __OSUnmaskInterrupts
/* 800874E0 00082A00  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800874E4 00082A04  7C 08 03 A6 */	mtlr r0
/* 800874E8 00082A08  38 21 00 10 */	addi r1, r1, 0x10
/* 800874EC 00082A0C  4E 80 00 20 */	blr 

glabel DBQueryData
/* 800874F0 00082A10  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800874F4 00082A14  7C 08 02 A6 */	mflr r0
/* 800874F8 00082A18  38 60 00 00 */	li r3, 0
/* 800874FC 00082A1C  90 01 00 24 */	stw r0, 0x24(r1)
/* 80087500 00082A20  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 80087504 00082A24  80 0D 89 28 */	lwz r0, lbl_80246DA8@sda21(r13)
/* 80087508 00082A28  98 6D 89 20 */	stb r3, lbl_80246DA0@sda21(r13)
/* 8008750C 00082A2C  2C 00 00 00 */	cmpwi r0, 0
/* 80087510 00082A30  40 82 00 6C */	bne .L_8008757C
/* 80087514 00082A34  48 00 DD A1 */	bl OSDisableInterrupts
/* 80087518 00082A38  7C 7F 1B 78 */	mr r31, r3
/* 8008751C 00082A3C  38 81 00 08 */	addi r4, r1, 8
/* 80087520 00082A40  3C 60 34 00 */	lis r3, 0x3400
/* 80087524 00082A44  38 A0 00 01 */	li r5, 1
/* 80087528 00082A48  48 00 05 A9 */	bl __DBEXIReadReg
/* 8008752C 00082A4C  88 01 00 08 */	lbz r0, 8(r1)
/* 80087530 00082A50  54 00 07 39 */	rlwinm. r0, r0, 0, 0x1c, 0x1c
/* 80087534 00082A54  40 82 00 40 */	bne .L_80087574
/* 80087538 00082A58  3C 60 34 00 */	lis r3, 0x34000200@ha
/* 8008753C 00082A5C  38 81 00 0C */	addi r4, r1, 0xc
/* 80087540 00082A60  38 63 02 00 */	addi r3, r3, 0x34000200@l
/* 80087544 00082A64  38 A0 00 04 */	li r5, 4
/* 80087548 00082A68  48 00 05 89 */	bl __DBEXIReadReg
/* 8008754C 00082A6C  80 81 00 0C */	lwz r4, 0xc(r1)
/* 80087550 00082A70  54 83 00 CE */	rlwinm r3, r4, 0, 3, 7
/* 80087554 00082A74  3C 03 E1 00 */	addis r0, r3, 0xe100
/* 80087558 00082A78  28 00 00 00 */	cmplwi r0, 0
/* 8008755C 00082A7C  40 82 00 18 */	bne .L_80087574
/* 80087560 00082A80  54 83 04 FE */	clrlwi r3, r4, 0x13
/* 80087564 00082A84  38 00 00 01 */	li r0, 1
/* 80087568 00082A88  90 8D 89 24 */	stw r4, lbl_80246DA4@sda21(r13)
/* 8008756C 00082A8C  90 6D 89 28 */	stw r3, lbl_80246DA8@sda21(r13)
/* 80087570 00082A90  98 0D 89 20 */	stb r0, lbl_80246DA0@sda21(r13)
.L_80087574:
/* 80087574 00082A94  7F E3 FB 78 */	mr r3, r31
/* 80087578 00082A98  48 00 DD 65 */	bl OSRestoreInterrupts
.L_8008757C:
/* 8008757C 00082A9C  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 80087580 00082AA0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 80087584 00082AA4  80 6D 89 28 */	lwz r3, lbl_80246DA8@sda21(r13)
/* 80087588 00082AA8  7C 08 03 A6 */	mtlr r0
/* 8008758C 00082AAC  38 21 00 20 */	addi r1, r1, 0x20
/* 80087590 00082AB0  4E 80 00 20 */	blr 

glabel DBRead
/* 80087594 00082AB4  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80087598 00082AB8  7C 08 02 A6 */	mflr r0
/* 8008759C 00082ABC  90 01 00 14 */	stw r0, 0x14(r1)
/* 800875A0 00082AC0  93 E1 00 0C */	stw r31, 0xc(r1)
/* 800875A4 00082AC4  7C 9F 23 78 */	mr r31, r4
/* 800875A8 00082AC8  93 C1 00 08 */	stw r30, 8(r1)
/* 800875AC 00082ACC  7C 7E 1B 78 */	mr r30, r3
/* 800875B0 00082AD0  48 00 DD 05 */	bl OSDisableInterrupts
/* 800875B4 00082AD4  80 AD 89 24 */	lwz r5, lbl_80246DA4@sda21(r13)
/* 800875B8 00082AD8  38 1F 00 03 */	addi r0, r31, 3
/* 800875BC 00082ADC  7C 7F 1B 78 */	mr r31, r3
/* 800875C0 00082AE0  7F C4 F3 78 */	mr r4, r30
/* 800875C4 00082AE4  54 A3 87 FE */	rlwinm r3, r5, 0x10, 0x1f, 0x1f
/* 800875C8 00082AE8  54 05 00 3A */	rlwinm r5, r0, 0, 0, 0x1d
/* 800875CC 00082AEC  7C 03 00 D0 */	neg r0, r3
/* 800875D0 00082AF0  54 03 05 28 */	rlwinm r3, r0, 0, 0x14, 0x14
/* 800875D4 00082AF4  3C 63 00 D1 */	addis r3, r3, 0xd1
/* 800875D8 00082AF8  38 03 10 00 */	addi r0, r3, 0x1000
/* 800875DC 00082AFC  54 03 30 AE */	rlwinm r3, r0, 6, 2, 0x17
/* 800875E0 00082B00  48 00 07 19 */	bl __DBEXIReadRam
/* 800875E4 00082B04  38 00 00 00 */	li r0, 0
/* 800875E8 00082B08  7F E3 FB 78 */	mr r3, r31
/* 800875EC 00082B0C  90 0D 89 28 */	stw r0, lbl_80246DA8@sda21(r13)
/* 800875F0 00082B10  98 0D 89 20 */	stb r0, lbl_80246DA0@sda21(r13)
/* 800875F4 00082B14  48 00 DC E9 */	bl OSRestoreInterrupts
/* 800875F8 00082B18  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 800875FC 00082B1C  38 60 00 00 */	li r3, 0
/* 80087600 00082B20  83 C1 00 08 */	lwz r30, 8(r1)
/* 80087604 00082B24  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80087608 00082B28  7C 08 03 A6 */	mtlr r0
/* 8008760C 00082B2C  38 21 00 10 */	addi r1, r1, 0x10
/* 80087610 00082B30  4E 80 00 20 */	blr 

glabel DBWrite
/* 80087614 00082B34  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 80087618 00082B38  7C 08 02 A6 */	mflr r0
/* 8008761C 00082B3C  90 01 00 34 */	stw r0, 0x34(r1)
/* 80087620 00082B40  39 61 00 30 */	addi r11, r1, 0x30
/* 80087624 00082B44  48 0D 53 21 */	bl _savegpr_27
/* 80087628 00082B48  7C 7B 1B 78 */	mr r27, r3
/* 8008762C 00082B4C  7C 9C 23 78 */	mr r28, r4
/* 80087630 00082B50  48 00 DC 85 */	bl OSDisableInterrupts
/* 80087634 00082B54  7C 7F 1B 78 */	mr r31, r3
.L_80087638:
/* 80087638 00082B58  38 81 00 0A */	addi r4, r1, 0xa
/* 8008763C 00082B5C  3C 60 34 00 */	lis r3, 0x3400
/* 80087640 00082B60  38 A0 00 01 */	li r5, 1
/* 80087644 00082B64  48 00 04 8D */	bl __DBEXIReadReg
/* 80087648 00082B68  88 01 00 0A */	lbz r0, 0xa(r1)
/* 8008764C 00082B6C  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 80087650 00082B70  40 82 FF E8 */	bne .L_80087638
/* 80087654 00082B74  88 6D 81 D0 */	lbz r3, lbl_80246650@sda21(r13)
/* 80087658 00082B78  38 1C 00 03 */	addi r0, r28, 3
/* 8008765C 00082B7C  54 1D 00 3A */	rlwinm r29, r0, 0, 0, 0x1d
/* 80087660 00082B80  38 63 00 01 */	addi r3, r3, 1
/* 80087664 00082B84  54 60 07 FE */	clrlwi r0, r3, 0x1f
/* 80087668 00082B88  98 6D 81 D0 */	stb r3, lbl_80246650@sda21(r13)
/* 8008766C 00082B8C  7C 00 00 D0 */	neg r0, r0
/* 80087670 00082B90  54 03 05 28 */	rlwinm r3, r0, 0, 0x14, 0x14
/* 80087674 00082B94  3C 03 00 D1 */	addis r0, r3, 0xd1
/* 80087678 00082B98  54 00 30 AE */	rlwinm r0, r0, 6, 2, 0x17
/* 8008767C 00082B9C  64 1E 80 00 */	oris r30, r0, 0x8000
.L_80087680:
/* 80087680 00082BA0  7F C3 F3 78 */	mr r3, r30
/* 80087684 00082BA4  7F 64 DB 78 */	mr r4, r27
/* 80087688 00082BA8  7F A5 EB 78 */	mr r5, r29
/* 8008768C 00082BAC  48 00 07 4D */	bl __DBEXIWriteRam
/* 80087690 00082BB0  2C 03 00 00 */	cmpwi r3, 0
/* 80087694 00082BB4  41 82 FF EC */	beq .L_80087680
.L_80087698:
/* 80087698 00082BB8  38 81 00 09 */	addi r4, r1, 9
/* 8008769C 00082BBC  3C 60 34 00 */	lis r3, 0x3400
/* 800876A0 00082BC0  38 A0 00 01 */	li r5, 1
/* 800876A4 00082BC4  48 00 04 2D */	bl __DBEXIReadReg
/* 800876A8 00082BC8  88 01 00 09 */	lbz r0, 9(r1)
/* 800876AC 00082BCC  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 800876B0 00082BD0  40 82 FF E8 */	bne .L_80087698
/* 800876B4 00082BD4  88 6D 81 D0 */	lbz r3, lbl_80246650@sda21(r13)
/* 800876B8 00082BD8  57 80 04 FE */	clrlwi r0, r28, 0x13
/* 800876BC 00082BDC  64 1D 1F 00 */	oris r29, r0, 0x1f00
/* 800876C0 00082BE0  3F C0 B4 00 */	lis r30, 0xB4000100@ha
/* 800876C4 00082BE4  50 7D 82 1E */	rlwimi r29, r3, 0x10, 8, 0xf
.L_800876C8:
/* 800876C8 00082BE8  93 A1 00 0C */	stw r29, 0xc(r1)
/* 800876CC 00082BEC  38 7E 01 00 */	addi r3, r30, 0xB4000100@l
/* 800876D0 00082BF0  38 81 00 0C */	addi r4, r1, 0xc
/* 800876D4 00082BF4  38 A0 00 04 */	li r5, 4
/* 800876D8 00082BF8  48 00 05 1D */	bl __DBEXIWriteReg
/* 800876DC 00082BFC  2C 03 00 00 */	cmpwi r3, 0
/* 800876E0 00082C00  41 82 FF E8 */	beq .L_800876C8
.L_800876E4:
/* 800876E4 00082C04  38 81 00 08 */	addi r4, r1, 8
/* 800876E8 00082C08  3C 60 34 00 */	lis r3, 0x3400
/* 800876EC 00082C0C  38 A0 00 01 */	li r5, 1
/* 800876F0 00082C10  48 00 03 E1 */	bl __DBEXIReadReg
/* 800876F4 00082C14  88 01 00 08 */	lbz r0, 8(r1)
/* 800876F8 00082C18  54 00 07 7B */	rlwinm. r0, r0, 0, 0x1d, 0x1d
/* 800876FC 00082C1C  40 82 FF E8 */	bne .L_800876E4
/* 80087700 00082C20  7F E3 FB 78 */	mr r3, r31
/* 80087704 00082C24  48 00 DB D9 */	bl OSRestoreInterrupts
/* 80087708 00082C28  39 61 00 30 */	addi r11, r1, 0x30
/* 8008770C 00082C2C  38 60 00 00 */	li r3, 0
/* 80087710 00082C30  48 0D 52 81 */	bl _restgpr_27
/* 80087714 00082C34  80 01 00 34 */	lwz r0, 0x34(r1)
/* 80087718 00082C38  7C 08 03 A6 */	mtlr r0
/* 8008771C 00082C3C  38 21 00 30 */	addi r1, r1, 0x30
/* 80087720 00082C40  4E 80 00 20 */	blr 

glabel DBOpen
/* 80087724 00082C44  4E 80 00 20 */	blr 

glabel DBClose
/* 80087728 00082C48  4E 80 00 20 */	blr 

.section .sbss, "wa" # 0x80246B60 - 0x80247800

glabel lbl_80246D98
	.skip 0x4

glabel lbl_80246D9C
	.skip 0x4

glabel lbl_80246DA0
	.skip 0x4

glabel lbl_80246DA4
	.skip 0x4

glabel lbl_80246DA8
	.skip 0x8
    
