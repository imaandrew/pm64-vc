.include "macros.inc"

.section .text, "ax"

glabel EUARTInit
/* 800D3A8C 000CEFAC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800D3A90 000CEFB0  7C 08 02 A6 */	mflr r0
/* 800D3A94 000CEFB4  90 01 00 24 */	stw r0, 0x24(r1)
/* 800D3A98 000CEFB8  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800D3A9C 000CEFBC  80 0D 92 B0 */	lwz r0, lbl_80247730@sda21(r13)
/* 800D3AA0 000CEFC0  2C 00 00 00 */	cmpwi r0, 0
/* 800D3AA4 000CEFC4  41 82 00 0C */	beq lbl_800D3AB0
/* 800D3AA8 000CEFC8  38 60 00 01 */	li r3, 1
/* 800D3AAC 000CEFCC  48 00 00 C8 */	b lbl_800D3B74
lbl_800D3AB0:
/* 800D3AB0 000CEFD0  4B FB B1 CD */	bl OSGetConsoleType
/* 800D3AB4 000CEFD4  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 800D3AB8 000CEFD8  40 82 00 14 */	bne lbl_800D3ACC
/* 800D3ABC 000CEFDC  38 00 00 02 */	li r0, 2
/* 800D3AC0 000CEFE0  38 60 00 00 */	li r3, 0
/* 800D3AC4 000CEFE4  90 0D 92 B4 */	stw r0, lbl_80247734@sda21(r13)
/* 800D3AC8 000CEFE8  48 00 00 AC */	b lbl_800D3B74
lbl_800D3ACC:
/* 800D3ACC 000CEFEC  4B FC 17 E9 */	bl OSDisableInterrupts
/* 800D3AD0 000CEFF0  38 00 00 F2 */	li r0, 0xf2
/* 800D3AD4 000CEFF4  7C 7F 1B 78 */	mr r31, r3
/* 800D3AD8 000CEFF8  98 01 00 08 */	stb r0, 8(r1)
/* 800D3ADC 000CEFFC  38 C1 00 08 */	addi r6, r1, 8
/* 800D3AE0 000CF000  38 60 00 00 */	li r3, 0
/* 800D3AE4 000CF004  38 80 00 01 */	li r4, 1
/* 800D3AE8 000CF008  3C A0 B0 00 */	lis r5, 0xb000
/* 800D3AEC 000CF00C  38 E0 00 01 */	li r7, 1
/* 800D3AF0 000CF010  4B FC 90 8D */	bl EXIWriteReg
/* 800D3AF4 000CF014  2C 03 00 00 */	cmpwi r3, 0
/* 800D3AF8 000CF018  40 82 00 1C */	bne lbl_800D3B14
/* 800D3AFC 000CF01C  38 00 00 05 */	li r0, 5
/* 800D3B00 000CF020  7F E3 FB 78 */	mr r3, r31
/* 800D3B04 000CF024  90 0D 92 B4 */	stw r0, lbl_80247734@sda21(r13)
/* 800D3B08 000CF028  4B FC 17 D5 */	bl OSRestoreInterrupts
/* 800D3B0C 000CF02C  38 60 00 00 */	li r3, 0
/* 800D3B10 000CF030  48 00 00 64 */	b lbl_800D3B74
lbl_800D3B14:
/* 800D3B14 000CF034  38 00 00 F3 */	li r0, 0xf3
/* 800D3B18 000CF038  38 C1 00 08 */	addi r6, r1, 8
/* 800D3B1C 000CF03C  98 01 00 08 */	stb r0, 8(r1)
/* 800D3B20 000CF040  38 60 00 00 */	li r3, 0
/* 800D3B24 000CF044  38 80 00 01 */	li r4, 1
/* 800D3B28 000CF048  3C A0 B0 00 */	lis r5, 0xb000
/* 800D3B2C 000CF04C  38 E0 00 01 */	li r7, 1
/* 800D3B30 000CF050  4B FC 90 4D */	bl EXIWriteReg
/* 800D3B34 000CF054  2C 03 00 00 */	cmpwi r3, 0
/* 800D3B38 000CF058  40 82 00 1C */	bne lbl_800D3B54
/* 800D3B3C 000CF05C  38 00 00 05 */	li r0, 5
/* 800D3B40 000CF060  7F E3 FB 78 */	mr r3, r31
/* 800D3B44 000CF064  90 0D 92 B4 */	stw r0, lbl_80247734@sda21(r13)
/* 800D3B48 000CF068  4B FC 17 95 */	bl OSRestoreInterrupts
/* 800D3B4C 000CF06C  38 60 00 00 */	li r3, 0
/* 800D3B50 000CF070  48 00 00 24 */	b lbl_800D3B74
lbl_800D3B54:
/* 800D3B54 000CF074  7F E3 FB 78 */	mr r3, r31
/* 800D3B58 000CF078  4B FC 17 85 */	bl OSRestoreInterrupts
/* 800D3B5C 000CF07C  38 00 00 00 */	li r0, 0
/* 800D3B60 000CF080  38 60 00 01 */	li r3, 1
/* 800D3B64 000CF084  90 6D 92 B0 */	stw r3, lbl_80247730@sda21(r13)
/* 800D3B68 000CF088  38 60 00 01 */	li r3, 1
/* 800D3B6C 000CF08C  90 0D 92 B4 */	stw r0, lbl_80247734@sda21(r13)
/* 800D3B70 000CF090  90 0D 92 B8 */	stw r0, lbl_80247738@sda21(r13)
lbl_800D3B74:
/* 800D3B74 000CF094  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800D3B78 000CF098  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800D3B7C 000CF09C  7C 08 03 A6 */	mtlr r0
/* 800D3B80 000CF0A0  38 21 00 20 */	addi r1, r1, 0x20
/* 800D3B84 000CF0A4  4E 80 00 20 */	blr 

glabel InitializeUART
/* 800D3B88 000CF0A8  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 800D3B8C 000CF0AC  7C 08 02 A6 */	mflr r0
/* 800D3B90 000CF0B0  90 01 00 14 */	stw r0, 0x14(r1)
/* 800D3B94 000CF0B4  4B FB B0 E9 */	bl OSGetConsoleType
/* 800D3B98 000CF0B8  54 60 00 C7 */	rlwinm. r0, r3, 0, 3, 3
/* 800D3B9C 000CF0BC  40 82 00 14 */	bne lbl_800D3BB0
/* 800D3BA0 000CF0C0  38 00 00 00 */	li r0, 0
/* 800D3BA4 000CF0C4  38 60 00 02 */	li r3, 2
/* 800D3BA8 000CF0C8  90 0D 92 BC */	stw r0, lbl_8024773C@sda21(r13)
/* 800D3BAC 000CF0CC  48 00 00 14 */	b lbl_800D3BC0
lbl_800D3BB0:
/* 800D3BB0 000CF0D0  3C 80 A5 FF */	lis r4, 0xA5FF005A@ha
/* 800D3BB4 000CF0D4  38 60 00 00 */	li r3, 0
/* 800D3BB8 000CF0D8  38 04 00 5A */	addi r0, r4, 0xA5FF005A@l
/* 800D3BBC 000CF0DC  90 0D 92 BC */	stw r0, lbl_8024773C@sda21(r13)
lbl_800D3BC0:
/* 800D3BC0 000CF0E0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800D3BC4 000CF0E4  7C 08 03 A6 */	mtlr r0
/* 800D3BC8 000CF0E8  38 21 00 10 */	addi r1, r1, 0x10
/* 800D3BCC 000CF0EC  4E 80 00 20 */	blr 

glabel WriteUARTN
/* 800D3BD0 000CF0F0  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 800D3BD4 000CF0F4  7C 08 02 A6 */	mflr r0
/* 800D3BD8 000CF0F8  90 01 00 34 */	stw r0, 0x34(r1)
/* 800D3BDC 000CF0FC  39 61 00 30 */	addi r11, r1, 0x30
/* 800D3BE0 000CF100  48 08 8D 61 */	bl _savegpr_26
/* 800D3BE4 000CF104  80 AD 92 BC */	lwz r5, lbl_8024773C@sda21(r13)
/* 800D3BE8 000CF108  7C 7E 1B 78 */	mr r30, r3
/* 800D3BEC 000CF10C  7C 9F 23 78 */	mr r31, r4
/* 800D3BF0 000CF110  3C 05 5A 01 */	addis r0, r5, 0x5a01
/* 800D3BF4 000CF114  28 00 00 5A */	cmplwi r0, 0x5a
/* 800D3BF8 000CF118  41 82 00 0C */	beq lbl_800D3C04
/* 800D3BFC 000CF11C  38 60 00 02 */	li r3, 2
/* 800D3C00 000CF120  48 00 01 E4 */	b lbl_800D3DE4
lbl_800D3C04:
/* 800D3C04 000CF124  80 0D 92 B0 */	lwz r0, lbl_80247730@sda21(r13)
/* 800D3C08 000CF128  2C 00 00 00 */	cmpwi r0, 0
/* 800D3C0C 000CF12C  40 82 00 18 */	bne lbl_800D3C24
/* 800D3C10 000CF130  4B FF FE 7D */	bl EUARTInit
/* 800D3C14 000CF134  2C 03 00 00 */	cmpwi r3, 0
/* 800D3C18 000CF138  40 82 00 0C */	bne lbl_800D3C24
/* 800D3C1C 000CF13C  38 60 00 02 */	li r3, 2
/* 800D3C20 000CF140  48 00 01 C4 */	b lbl_800D3DE4
lbl_800D3C24:
/* 800D3C24 000CF144  80 0D 92 B0 */	lwz r0, lbl_80247730@sda21(r13)
/* 800D3C28 000CF148  2C 00 00 00 */	cmpwi r0, 0
/* 800D3C2C 000CF14C  40 82 00 14 */	bne lbl_800D3C40
/* 800D3C30 000CF150  38 00 00 01 */	li r0, 1
/* 800D3C34 000CF154  38 60 00 02 */	li r3, 2
/* 800D3C38 000CF158  90 0D 92 B4 */	stw r0, lbl_80247734@sda21(r13)
/* 800D3C3C 000CF15C  48 00 01 A8 */	b lbl_800D3DE4
lbl_800D3C40:
/* 800D3C40 000CF160  38 60 00 00 */	li r3, 0
/* 800D3C44 000CF164  38 80 00 01 */	li r4, 1
/* 800D3C48 000CF168  38 A0 00 00 */	li r5, 0
/* 800D3C4C 000CF16C  4B FC 86 55 */	bl EXILock
/* 800D3C50 000CF170  2C 03 00 00 */	cmpwi r3, 0
/* 800D3C54 000CF174  40 82 00 0C */	bne lbl_800D3C60
/* 800D3C58 000CF178  38 60 00 00 */	li r3, 0
/* 800D3C5C 000CF17C  48 00 01 88 */	b lbl_800D3DE4
lbl_800D3C60:
/* 800D3C60 000CF180  7F C4 F3 78 */	mr r4, r30
/* 800D3C64 000CF184  38 60 00 0D */	li r3, 0xd
/* 800D3C68 000CF188  48 00 00 18 */	b lbl_800D3C80
lbl_800D3C6C:
/* 800D3C6C 000CF18C  88 04 00 00 */	lbz r0, 0(r4)
/* 800D3C70 000CF190  2C 00 00 0A */	cmpwi r0, 0xa
/* 800D3C74 000CF194  40 82 00 08 */	bne lbl_800D3C7C
/* 800D3C78 000CF198  98 64 00 00 */	stb r3, 0(r4)
lbl_800D3C7C:
/* 800D3C7C 000CF19C  38 84 00 01 */	addi r4, r4, 1
lbl_800D3C80:
/* 800D3C80 000CF1A0  7C 1E 20 50 */	subf r0, r30, r4
/* 800D3C84 000CF1A4  7C 00 F8 40 */	cmplw r0, r31
/* 800D3C88 000CF1A8  41 80 FF E4 */	blt lbl_800D3C6C
/* 800D3C8C 000CF1AC  3C 60 B0 00 */	lis r3, 0xB0000100@ha
/* 800D3C90 000CF1B0  83 82 86 20 */	lwz r28, lbl_80247E20@sda21(r2)
/* 800D3C94 000CF1B4  38 03 01 00 */	addi r0, r3, 0xB0000100@l
/* 800D3C98 000CF1B8  3B 40 00 00 */	li r26, 0
/* 800D3C9C 000CF1BC  90 01 00 14 */	stw r0, 0x14(r1)
/* 800D3CA0 000CF1C0  3F A0 30 00 */	lis r29, 0x3000
/* 800D3CA4 000CF1C4  48 00 01 2C */	b lbl_800D3DD0
lbl_800D3CA8:
/* 800D3CA8 000CF1C8  7F 85 E3 78 */	mr r5, r28
/* 800D3CAC 000CF1CC  38 60 00 00 */	li r3, 0
/* 800D3CB0 000CF1D0  38 80 00 01 */	li r4, 1
/* 800D3CB4 000CF1D4  4B FC 7E 59 */	bl EXISelect
/* 800D3CB8 000CF1D8  2C 03 00 00 */	cmpwi r3, 0
/* 800D3CBC 000CF1DC  40 82 00 0C */	bne lbl_800D3CC8
/* 800D3CC0 000CF1E0  3B 60 FF FF */	li r27, -1
/* 800D3CC4 000CF1E4  48 00 00 60 */	b lbl_800D3D24
lbl_800D3CC8:
/* 800D3CC8 000CF1E8  38 1D 01 00 */	addi r0, r29, 0x100
/* 800D3CCC 000CF1EC  38 81 00 08 */	addi r4, r1, 8
/* 800D3CD0 000CF1F0  90 01 00 08 */	stw r0, 8(r1)
/* 800D3CD4 000CF1F4  38 60 00 00 */	li r3, 0
/* 800D3CD8 000CF1F8  38 A0 00 04 */	li r5, 4
/* 800D3CDC 000CF1FC  38 C0 00 01 */	li r6, 1
/* 800D3CE0 000CF200  38 E0 00 00 */	li r7, 0
/* 800D3CE4 000CF204  4B FC 73 C1 */	bl EXIImm
/* 800D3CE8 000CF208  38 60 00 00 */	li r3, 0
/* 800D3CEC 000CF20C  4B FC 77 D1 */	bl EXISync
/* 800D3CF0 000CF210  38 81 00 0C */	addi r4, r1, 0xc
/* 800D3CF4 000CF214  38 60 00 00 */	li r3, 0
/* 800D3CF8 000CF218  38 A0 00 04 */	li r5, 4
/* 800D3CFC 000CF21C  38 C0 00 00 */	li r6, 0
/* 800D3D00 000CF220  38 E0 00 00 */	li r7, 0
/* 800D3D04 000CF224  4B FC 73 A1 */	bl EXIImm
/* 800D3D08 000CF228  38 60 00 00 */	li r3, 0
/* 800D3D0C 000CF22C  4B FC 77 B1 */	bl EXISync
/* 800D3D10 000CF230  38 60 00 00 */	li r3, 0
/* 800D3D14 000CF234  4B FC 7F 29 */	bl EXIDeselect
/* 800D3D18 000CF238  80 01 00 0C */	lwz r0, 0xc(r1)
/* 800D3D1C 000CF23C  54 00 46 BE */	rlwinm r0, r0, 8, 0x1a, 0x1f
/* 800D3D20 000CF240  23 60 00 20 */	subfic r27, r0, 0x20
lbl_800D3D24:
/* 800D3D24 000CF244  2C 1B 00 00 */	cmpwi r27, 0
/* 800D3D28 000CF248  40 80 00 0C */	bge lbl_800D3D34
/* 800D3D2C 000CF24C  3B 40 00 03 */	li r26, 3
/* 800D3D30 000CF250  48 00 00 A8 */	b lbl_800D3DD8
lbl_800D3D34:
/* 800D3D34 000CF254  2C 1B 00 20 */	cmpwi r27, 0x20
/* 800D3D38 000CF258  40 82 00 98 */	bne lbl_800D3DD0
/* 800D3D3C 000CF25C  7F 85 E3 78 */	mr r5, r28
/* 800D3D40 000CF260  38 60 00 00 */	li r3, 0
/* 800D3D44 000CF264  38 80 00 01 */	li r4, 1
/* 800D3D48 000CF268  4B FC 7D C5 */	bl EXISelect
/* 800D3D4C 000CF26C  2C 03 00 00 */	cmpwi r3, 0
/* 800D3D50 000CF270  40 82 00 0C */	bne lbl_800D3D5C
/* 800D3D54 000CF274  3B 40 00 03 */	li r26, 3
/* 800D3D58 000CF278  48 00 00 80 */	b lbl_800D3DD8
lbl_800D3D5C:
/* 800D3D5C 000CF27C  38 81 00 14 */	addi r4, r1, 0x14
/* 800D3D60 000CF280  38 60 00 00 */	li r3, 0
/* 800D3D64 000CF284  38 A0 00 04 */	li r5, 4
/* 800D3D68 000CF288  38 C0 00 01 */	li r6, 1
/* 800D3D6C 000CF28C  38 E0 00 00 */	li r7, 0
/* 800D3D70 000CF290  4B FC 73 35 */	bl EXIImm
/* 800D3D74 000CF294  38 60 00 00 */	li r3, 0
/* 800D3D78 000CF298  4B FC 77 45 */	bl EXISync
/* 800D3D7C 000CF29C  48 00 00 3C */	b lbl_800D3DB8
lbl_800D3D80:
/* 800D3D80 000CF2A0  88 1E 00 00 */	lbz r0, 0(r30)
/* 800D3D84 000CF2A4  38 81 00 10 */	addi r4, r1, 0x10
/* 800D3D88 000CF2A8  38 60 00 00 */	li r3, 0
/* 800D3D8C 000CF2AC  38 A0 00 04 */	li r5, 4
/* 800D3D90 000CF2B0  54 00 C0 0E */	slwi r0, r0, 0x18
/* 800D3D94 000CF2B4  38 C0 00 01 */	li r6, 1
/* 800D3D98 000CF2B8  90 01 00 10 */	stw r0, 0x10(r1)
/* 800D3D9C 000CF2BC  38 E0 00 00 */	li r7, 0
/* 800D3DA0 000CF2C0  4B FC 73 05 */	bl EXIImm
/* 800D3DA4 000CF2C4  38 60 00 00 */	li r3, 0
/* 800D3DA8 000CF2C8  4B FC 77 15 */	bl EXISync
/* 800D3DAC 000CF2CC  3B DE 00 01 */	addi r30, r30, 1
/* 800D3DB0 000CF2D0  3B 7B FF FF */	addi r27, r27, -1
/* 800D3DB4 000CF2D4  3B FF FF FF */	addi r31, r31, -1
lbl_800D3DB8:
/* 800D3DB8 000CF2D8  2C 1B 00 00 */	cmpwi r27, 0
/* 800D3DBC 000CF2DC  40 81 00 0C */	ble lbl_800D3DC8
/* 800D3DC0 000CF2E0  2C 1F 00 00 */	cmpwi r31, 0
/* 800D3DC4 000CF2E4  40 82 FF BC */	bne lbl_800D3D80
lbl_800D3DC8:
/* 800D3DC8 000CF2E8  38 60 00 00 */	li r3, 0
/* 800D3DCC 000CF2EC  4B FC 7E 71 */	bl EXIDeselect
lbl_800D3DD0:
/* 800D3DD0 000CF2F0  2C 1F 00 00 */	cmpwi r31, 0
/* 800D3DD4 000CF2F4  40 82 FE D4 */	bne lbl_800D3CA8
lbl_800D3DD8:
/* 800D3DD8 000CF2F8  38 60 00 00 */	li r3, 0
/* 800D3DDC 000CF2FC  4B FC 85 C1 */	bl EXIUnlock
/* 800D3DE0 000CF300  7F 43 D3 78 */	mr r3, r26
lbl_800D3DE4:
/* 800D3DE4 000CF304  39 61 00 30 */	addi r11, r1, 0x30
/* 800D3DE8 000CF308  48 08 8B A5 */	bl _restgpr_26
/* 800D3DEC 000CF30C  80 01 00 34 */	lwz r0, 0x34(r1)
/* 800D3DF0 000CF310  7C 08 03 A6 */	mtlr r0
/* 800D3DF4 000CF314  38 21 00 30 */	addi r1, r1, 0x30
/* 800D3DF8 000CF318  4E 80 00 20 */	blr 

.section .sbss, "wa" # 0x80246B60 - 0x80247800

glabel lbl_80247730
	.skip 0x4

glabel lbl_80247734
	.skip 0x4

glabel lbl_80247738
	.skip 0x4

glabel lbl_8024773C
	.skip 0x4