.include "macros.inc"

.section .text, "ax"

glabel nandCalcUsage
/* 800BC044 000B7564  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800BC048 000B7568  7C 08 02 A6 */	mflr r0
/* 800BC04C 000B756C  90 01 00 24 */	stw r0, 0x24(r1)
/* 800BC050 000B7570  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800BC054 000B7574  3B E0 00 00 */	li r31, 0
/* 800BC058 000B7578  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800BC05C 000B757C  7C BE 2B 78 */	mr r30, r5
/* 800BC060 000B7580  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800BC064 000B7584  7C 9D 23 78 */	mr r29, r4
/* 800BC068 000B7588  93 81 00 10 */	stw r28, 0x10(r1)
/* 800BC06C 000B758C  7C 7C 1B 78 */	mr r28, r3
/* 800BC070 000B7590  93 E3 00 00 */	stw r31, 0(r3)
/* 800BC074 000B7594  38 60 FF 8B */	li r3, -117
/* 800BC078 000B7598  93 E4 00 00 */	stw r31, 0(r4)
/* 800BC07C 000B759C  48 00 00 58 */	b .L_800BC0D4
.L_800BC080:
/* 800BC080 000B75A0  93 E1 00 0C */	stw r31, 0xc(r1)
/* 800BC084 000B75A4  38 81 00 0C */	addi r4, r1, 0xc
/* 800BC088 000B75A8  38 A1 00 08 */	addi r5, r1, 8
/* 800BC08C 000B75AC  93 E1 00 08 */	stw r31, 8(r1)
/* 800BC090 000B75B0  80 7E 00 00 */	lwz r3, 0(r30)
/* 800BC094 000B75B4  48 00 58 11 */	bl ISFS_GetUsage
/* 800BC098 000B75B8  2C 03 00 00 */	cmpwi r3, 0
/* 800BC09C 000B75BC  40 82 00 28 */	bne .L_800BC0C4
/* 800BC0A0 000B75C0  80 9C 00 00 */	lwz r4, 0(r28)
/* 800BC0A4 000B75C4  80 01 00 0C */	lwz r0, 0xc(r1)
/* 800BC0A8 000B75C8  7C 04 02 14 */	add r0, r4, r0
/* 800BC0AC 000B75CC  90 1C 00 00 */	stw r0, 0(r28)
/* 800BC0B0 000B75D0  80 9D 00 00 */	lwz r4, 0(r29)
/* 800BC0B4 000B75D4  80 01 00 08 */	lwz r0, 8(r1)
/* 800BC0B8 000B75D8  7C 04 02 14 */	add r0, r4, r0
/* 800BC0BC 000B75DC  90 1D 00 00 */	stw r0, 0(r29)
/* 800BC0C0 000B75E0  48 00 00 10 */	b .L_800BC0D0
.L_800BC0C4:
/* 800BC0C4 000B75E4  2C 03 FF 96 */	cmpwi r3, -106
/* 800BC0C8 000B75E8  40 82 00 18 */	bne .L_800BC0E0
/* 800BC0CC 000B75EC  38 60 00 00 */	li r3, 0
.L_800BC0D0:
/* 800BC0D0 000B75F0  3B DE 00 04 */	addi r30, r30, 4
.L_800BC0D4:
/* 800BC0D4 000B75F4  80 1E 00 00 */	lwz r0, 0(r30)
/* 800BC0D8 000B75F8  2C 00 00 00 */	cmpwi r0, 0
/* 800BC0DC 000B75FC  40 82 FF A4 */	bne .L_800BC080
.L_800BC0E0:
/* 800BC0E0 000B7600  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800BC0E4 000B7604  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800BC0E8 000B7608  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800BC0EC 000B760C  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800BC0F0 000B7610  83 81 00 10 */	lwz r28, 0x10(r1)
/* 800BC0F4 000B7614  7C 08 03 A6 */	mtlr r0
/* 800BC0F8 000B7618  38 21 00 20 */	addi r1, r1, 0x20
/* 800BC0FC 000B761C  4E 80 00 20 */	blr

glabel NANDCheck
/* 800BC100 000B7620  94 21 FF D0 */	stwu r1, -0x30(r1)
/* 800BC104 000B7624  7C 08 02 A6 */	mflr r0
/* 800BC108 000B7628  90 01 00 34 */	stw r0, 0x34(r1)
/* 800BC10C 000B762C  38 00 FF FF */	li r0, -1
/* 800BC110 000B7630  93 E1 00 2C */	stw r31, 0x2c(r1)
/* 800BC114 000B7634  7C BF 2B 78 */	mr r31, r5
/* 800BC118 000B7638  93 C1 00 28 */	stw r30, 0x28(r1)
/* 800BC11C 000B763C  7C 9E 23 78 */	mr r30, r4
/* 800BC120 000B7640  93 A1 00 24 */	stw r29, 0x24(r1)
/* 800BC124 000B7644  7C 7D 1B 78 */	mr r29, r3
/* 800BC128 000B7648  90 01 00 14 */	stw r0, 0x14(r1)
/* 800BC12C 000B764C  90 01 00 10 */	stw r0, 0x10(r1)
/* 800BC130 000B7650  90 01 00 0C */	stw r0, 0xc(r1)
/* 800BC134 000B7654  90 01 00 08 */	stw r0, 8(r1)
/* 800BC138 000B7658  4B FF EB A1 */	bl nandIsInitialized
/* 800BC13C 000B765C  2C 03 00 00 */	cmpwi r3, 0
/* 800BC140 000B7660  40 82 00 0C */	bne .L_800BC14C
/* 800BC144 000B7664  38 60 FF 80 */	li r3, -128
/* 800BC148 000B7668  48 00 00 A4 */	b .L_800BC1EC
.L_800BC14C:
/* 800BC14C 000B766C  4B FF FD 75 */	bl nandGetHomeDir
/* 800BC150 000B7670  38 81 00 14 */	addi r4, r1, 0x14
/* 800BC154 000B7674  38 A1 00 10 */	addi r5, r1, 0x10
/* 800BC158 000B7678  48 00 57 4D */	bl ISFS_GetUsage
/* 800BC15C 000B767C  2C 03 00 00 */	cmpwi r3, 0
/* 800BC160 000B7680  41 82 00 0C */	beq .L_800BC16C
/* 800BC164 000B7684  4B FF EB 8D */	bl nandConvertErrorCode
/* 800BC168 000B7688  48 00 00 84 */	b .L_800BC1EC
.L_800BC16C:
/* 800BC16C 000B768C  3C A0 80 19 */	lis r5, lbl_80196D20@ha
/* 800BC170 000B7690  38 61 00 0C */	addi r3, r1, 0xc
/* 800BC174 000B7694  38 81 00 08 */	addi r4, r1, 8
/* 800BC178 000B7698  38 A5 6D 20 */	addi r5, r5, lbl_80196D20@l
/* 800BC17C 000B769C  4B FF FE C9 */	bl nandCalcUsage
/* 800BC180 000B76A0  2C 03 00 00 */	cmpwi r3, 0
/* 800BC184 000B76A4  41 82 00 0C */	beq .L_800BC190
/* 800BC188 000B76A8  4B FF EB 69 */	bl nandConvertErrorCode
/* 800BC18C 000B76AC  48 00 00 60 */	b .L_800BC1EC
.L_800BC190:
/* 800BC190 000B76B0  80 01 00 14 */	lwz r0, 0x14(r1)
/* 800BC194 000B76B4  38 A0 00 00 */	li r5, 0
/* 800BC198 000B76B8  80 81 00 08 */	lwz r4, 8(r1)
/* 800BC19C 000B76BC  7C 00 EA 14 */	add r0, r0, r29
/* 800BC1A0 000B76C0  80 61 00 0C */	lwz r3, 0xc(r1)
/* 800BC1A4 000B76C4  28 00 04 00 */	cmplwi r0, 0x400
/* 800BC1A8 000B76C8  80 01 00 10 */	lwz r0, 0x10(r1)
/* 800BC1AC 000B76CC  40 81 00 08 */	ble .L_800BC1B4
/* 800BC1B0 000B76D0  60 A5 00 01 */	ori r5, r5, 1
.L_800BC1B4:
/* 800BC1B4 000B76D4  7C 00 F2 14 */	add r0, r0, r30
/* 800BC1B8 000B76D8  28 00 00 21 */	cmplwi r0, 0x21
/* 800BC1BC 000B76DC  40 81 00 08 */	ble .L_800BC1C4
/* 800BC1C0 000B76E0  60 A5 00 02 */	ori r5, r5, 2
.L_800BC1C4:
/* 800BC1C4 000B76E4  7C 03 EA 14 */	add r0, r3, r29
/* 800BC1C8 000B76E8  28 00 44 00 */	cmplwi r0, 0x4400
/* 800BC1CC 000B76EC  40 81 00 08 */	ble .L_800BC1D4
/* 800BC1D0 000B76F0  60 A5 00 04 */	ori r5, r5, 4
.L_800BC1D4:
/* 800BC1D4 000B76F4  7C 04 F2 14 */	add r0, r4, r30
/* 800BC1D8 000B76F8  28 00 0F A0 */	cmplwi r0, 0xfa0
/* 800BC1DC 000B76FC  40 81 00 08 */	ble .L_800BC1E4
/* 800BC1E0 000B7700  60 A5 00 08 */	ori r5, r5, 8
.L_800BC1E4:
/* 800BC1E4 000B7704  90 BF 00 00 */	stw r5, 0(r31)
/* 800BC1E8 000B7708  38 60 00 00 */	li r3, 0
.L_800BC1EC:
/* 800BC1EC 000B770C  80 01 00 34 */	lwz r0, 0x34(r1)
/* 800BC1F0 000B7710  83 E1 00 2C */	lwz r31, 0x2c(r1)
/* 800BC1F4 000B7714  83 C1 00 28 */	lwz r30, 0x28(r1)
/* 800BC1F8 000B7718  83 A1 00 24 */	lwz r29, 0x24(r1)
/* 800BC1FC 000B771C  7C 08 03 A6 */	mtlr r0
/* 800BC200 000B7720  38 21 00 30 */	addi r1, r1, 0x30
/* 800BC204 000B7724  4E 80 00 20 */	blr
