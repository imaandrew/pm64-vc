.include "macros.inc"

.section .text, "ax"

glabel DCEnable
/* 80090C2C 0008C14C  7C 00 04 AC */	sync 0
/* 80090C30 0008C150  7C 70 FA A6 */	mfspr r3, 0x3f0
/* 80090C34 0008C154  60 63 40 00 */	ori r3, r3, 0x4000
/* 80090C38 0008C158  7C 70 FB A6 */	mtspr 0x3f0, r3
/* 80090C3C 0008C15C  4E 80 00 20 */	blr

glabel DCInvalidateRange
/* 80090C40 0008C160  28 04 00 00 */	cmplwi r4, 0
/* 80090C44 0008C164  4C 81 00 20 */	blelr
/* 80090C48 0008C168  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090C4C 0008C16C  7C 84 2A 14 */	add r4, r4, r5
/* 80090C50 0008C170  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090C54 0008C174  54 84 D9 7E */	srwi r4, r4, 5
/* 80090C58 0008C178  7C 89 03 A6 */	mtctr r4
.L_80090C5C:
/* 80090C5C 0008C17C  7C 00 1B AC */	dcbi 0, r3
/* 80090C60 0008C180  38 63 00 20 */	addi r3, r3, 0x20
/* 80090C64 0008C184  42 00 FF F8 */	bdnz .L_80090C5C
/* 80090C68 0008C188  4E 80 00 20 */	blr

glabel DCFlushRange
/* 80090C6C 0008C18C  28 04 00 00 */	cmplwi r4, 0
/* 80090C70 0008C190  4C 81 00 20 */	blelr
/* 80090C74 0008C194  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090C78 0008C198  7C 84 2A 14 */	add r4, r4, r5
/* 80090C7C 0008C19C  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090C80 0008C1A0  54 84 D9 7E */	srwi r4, r4, 5
/* 80090C84 0008C1A4  7C 89 03 A6 */	mtctr r4
.L_80090C88:
/* 80090C88 0008C1A8  7C 00 18 AC */	dcbf 0, r3
/* 80090C8C 0008C1AC  38 63 00 20 */	addi r3, r3, 0x20
/* 80090C90 0008C1B0  42 00 FF F8 */	bdnz .L_80090C88
/* 80090C94 0008C1B4  44 00 00 02 */	sc
/* 80090C98 0008C1B8  4E 80 00 20 */	blr

glabel DCStoreRange
/* 80090C9C 0008C1BC  28 04 00 00 */	cmplwi r4, 0
/* 80090CA0 0008C1C0  4C 81 00 20 */	blelr
/* 80090CA4 0008C1C4  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090CA8 0008C1C8  7C 84 2A 14 */	add r4, r4, r5
/* 80090CAC 0008C1CC  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090CB0 0008C1D0  54 84 D9 7E */	srwi r4, r4, 5
/* 80090CB4 0008C1D4  7C 89 03 A6 */	mtctr r4
.L_80090CB8:
/* 80090CB8 0008C1D8  7C 00 18 6C */	dcbst 0, r3
/* 80090CBC 0008C1DC  38 63 00 20 */	addi r3, r3, 0x20
/* 80090CC0 0008C1E0  42 00 FF F8 */	bdnz .L_80090CB8
/* 80090CC4 0008C1E4  44 00 00 02 */	sc
/* 80090CC8 0008C1E8  4E 80 00 20 */	blr

glabel DCFlushRangeNoSync
/* 80090CCC 0008C1EC  28 04 00 00 */	cmplwi r4, 0
/* 80090CD0 0008C1F0  4C 81 00 20 */	blelr
/* 80090CD4 0008C1F4  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090CD8 0008C1F8  7C 84 2A 14 */	add r4, r4, r5
/* 80090CDC 0008C1FC  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090CE0 0008C200  54 84 D9 7E */	srwi r4, r4, 5
/* 80090CE4 0008C204  7C 89 03 A6 */	mtctr r4
.L_80090CE8:
/* 80090CE8 0008C208  7C 00 18 AC */	dcbf 0, r3
/* 80090CEC 0008C20C  38 63 00 20 */	addi r3, r3, 0x20
/* 80090CF0 0008C210  42 00 FF F8 */	bdnz .L_80090CE8
/* 80090CF4 0008C214  4E 80 00 20 */	blr

glabel DCZeroRange
/* 80090CF8 0008C218  28 04 00 00 */	cmplwi r4, 0
/* 80090CFC 0008C21C  4C 81 00 20 */	blelr
/* 80090D00 0008C220  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090D04 0008C224  7C 84 2A 14 */	add r4, r4, r5
/* 80090D08 0008C228  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090D0C 0008C22C  54 84 D9 7E */	srwi r4, r4, 5
/* 80090D10 0008C230  7C 89 03 A6 */	mtctr r4
.L_80090D14:
/* 80090D14 0008C234  7C 00 1F EC */	dcbz 0, r3
/* 80090D18 0008C238  38 63 00 20 */	addi r3, r3, 0x20
/* 80090D1C 0008C23C  42 00 FF F8 */	bdnz .L_80090D14
/* 80090D20 0008C240  4E 80 00 20 */	blr

glabel ICInvalidateRange
/* 80090D24 0008C244  28 04 00 00 */	cmplwi r4, 0
/* 80090D28 0008C248  4C 81 00 20 */	blelr
/* 80090D2C 0008C24C  54 65 06 FE */	clrlwi r5, r3, 0x1b
/* 80090D30 0008C250  7C 84 2A 14 */	add r4, r4, r5
/* 80090D34 0008C254  38 84 00 1F */	addi r4, r4, 0x1f
/* 80090D38 0008C258  54 84 D9 7E */	srwi r4, r4, 5
/* 80090D3C 0008C25C  7C 89 03 A6 */	mtctr r4
.L_80090D40:
/* 80090D40 0008C260  7C 00 1F AC */	icbi 0, r3
/* 80090D44 0008C264  38 63 00 20 */	addi r3, r3, 0x20
/* 80090D48 0008C268  42 00 FF F8 */	bdnz .L_80090D40
/* 80090D4C 0008C26C  7C 00 04 AC */	sync 0
/* 80090D50 0008C270  4C 00 01 2C */	isync
/* 80090D54 0008C274  4E 80 00 20 */	blr

glabel ICFlashInvalidate
/* 80090D58 0008C278  7C 70 FA A6 */	mfspr r3, 0x3f0
/* 80090D5C 0008C27C  60 63 08 00 */	ori r3, r3, 0x800
/* 80090D60 0008C280  7C 70 FB A6 */	mtspr 0x3f0, r3
/* 80090D64 0008C284  4E 80 00 20 */	blr

glabel ICEnable
/* 80090D68 0008C288  4C 00 01 2C */	isync
/* 80090D6C 0008C28C  7C 70 FA A6 */	mfspr r3, 0x3f0
/* 80090D70 0008C290  60 63 80 00 */	ori r3, r3, 0x8000
/* 80090D74 0008C294  7C 70 FB A6 */	mtspr 0x3f0, r3
/* 80090D78 0008C298  4E 80 00 20 */	blr

glabel LCDisable
/* 80090D7C 0008C29C  3C 60 E0 00 */	lis r3, 0xE0000020@ha
/* 80090D80 0008C2A0  38 80 02 00 */	li r4, 0x200
/* 80090D84 0008C2A4  7C 89 03 A6 */	mtctr r4
.L_80090D88:
/* 80090D88 0008C2A8  7C 00 1B AC */	dcbi 0, r3
/* 80090D8C 0008C2AC  38 63 00 20 */	addi r3, r3, 0xE0000020@l
/* 80090D90 0008C2B0  42 00 FF F8 */	bdnz .L_80090D88
/* 80090D94 0008C2B4  7C 98 E2 A6 */	mfspr r4, 0x398
/* 80090D98 0008C2B8  54 84 01 04 */	rlwinm r4, r4, 0, 4, 2
/* 80090D9C 0008C2BC  7C 98 E3 A6 */	mtspr 0x398, r4
/* 80090DA0 0008C2C0  4E 80 00 20 */	blr

glabel DMAErrorHandler
/* 80090DA4 0008C2C4  94 21 FF 80 */	stwu r1, -0x80(r1)
/* 80090DA8 0008C2C8  7C 08 02 A6 */	mflr r0
/* 80090DAC 0008C2CC  90 01 00 84 */	stw r0, 0x84(r1)
/* 80090DB0 0008C2D0  93 E1 00 7C */	stw r31, 0x7c(r1)
/* 80090DB4 0008C2D4  93 C1 00 78 */	stw r30, 0x78(r1)
/* 80090DB8 0008C2D8  93 A1 00 74 */	stw r29, 0x74(r1)
/* 80090DBC 0008C2DC  7C 9D 23 78 */	mr r29, r4
/* 80090DC0 0008C2E0  40 86 00 24 */	bne cr1, .L_80090DE4
/* 80090DC4 0008C2E4  D8 21 00 28 */	stfd f1, 0x28(r1)
/* 80090DC8 0008C2E8  D8 41 00 30 */	stfd f2, 0x30(r1)
/* 80090DCC 0008C2EC  D8 61 00 38 */	stfd f3, 0x38(r1)
/* 80090DD0 0008C2F0  D8 81 00 40 */	stfd f4, 0x40(r1)
/* 80090DD4 0008C2F4  D8 A1 00 48 */	stfd f5, 0x48(r1)
/* 80090DD8 0008C2F8  D8 C1 00 50 */	stfd f6, 0x50(r1)
/* 80090DDC 0008C2FC  D8 E1 00 58 */	stfd f7, 0x58(r1)
/* 80090DE0 0008C300  D9 01 00 60 */	stfd f8, 0x60(r1)
.L_80090DE4:
/* 80090DE4 0008C304  3F E0 80 18 */	lis r31, lbl_80182E08@ha
/* 80090DE8 0008C308  90 61 00 08 */	stw r3, 8(r1)
/* 80090DEC 0008C30C  3B FF 2E 08 */	addi r31, r31, lbl_80182E08@l
/* 80090DF0 0008C310  90 81 00 0C */	stw r4, 0xc(r1)
/* 80090DF4 0008C314  90 A1 00 10 */	stw r5, 0x10(r1)
/* 80090DF8 0008C318  90 C1 00 14 */	stw r6, 0x14(r1)
/* 80090DFC 0008C31C  90 E1 00 18 */	stw r7, 0x18(r1)
/* 80090E00 0008C320  91 01 00 1C */	stw r8, 0x1c(r1)
/* 80090E04 0008C324  91 21 00 20 */	stw r9, 0x20(r1)
/* 80090E08 0008C328  91 41 00 24 */	stw r10, 0x24(r1)
/* 80090E0C 0008C32C  4B FF DC 45 */	bl PPCMfhid2
/* 80090E10 0008C330  7C 7E 1B 78 */	mr r30, r3
/* 80090E14 0008C334  38 7F 00 30 */	addi r3, r31, 0x30
/* 80090E18 0008C338  4C C6 31 82 */	crclr 6
/* 80090E1C 0008C33C  48 00 0A 91 */	bl OSReport
/* 80090E20 0008C340  80 BD 01 9C */	lwz r5, 0x19c(r29)
/* 80090E24 0008C344  7F C4 F3 78 */	mr r4, r30
/* 80090E28 0008C348  38 7F 00 48 */	addi r3, r31, 0x48
/* 80090E2C 0008C34C  4C C6 31 82 */	crclr 6
/* 80090E30 0008C350  48 00 0A 7D */	bl OSReport
/* 80090E34 0008C354  57 C0 02 17 */	rlwinm. r0, r30, 0, 8, 0xb
/* 80090E38 0008C358  41 82 00 10 */	beq .L_80090E48
/* 80090E3C 0008C35C  80 1D 01 9C */	lwz r0, 0x19c(r29)
/* 80090E40 0008C360  54 00 02 95 */	rlwinm. r0, r0, 0, 0xa, 0xa
/* 80090E44 0008C364  40 82 00 1C */	bne .L_80090E60
.L_80090E48:
/* 80090E48 0008C368  38 7F 00 68 */	addi r3, r31, 0x68
/* 80090E4C 0008C36C  4C C6 31 82 */	crclr 6
/* 80090E50 0008C370  48 00 0A 5D */	bl OSReport
/* 80090E54 0008C374  7F A3 EB 78 */	mr r3, r29
/* 80090E58 0008C378  48 00 07 29 */	bl OSDumpContext
/* 80090E5C 0008C37C  4B FF DB 69 */	bl PPCHalt
.L_80090E60:
/* 80090E60 0008C380  38 7F 00 98 */	addi r3, r31, 0x98
/* 80090E64 0008C384  4C C6 31 82 */	crclr 6
/* 80090E68 0008C388  48 00 0A 45 */	bl OSReport
/* 80090E6C 0008C38C  38 7F 00 D4 */	addi r3, r31, 0xd4
/* 80090E70 0008C390  4C C6 31 82 */	crclr 6
/* 80090E74 0008C394  48 00 0A 39 */	bl OSReport
/* 80090E78 0008C398  57 C0 02 11 */	rlwinm. r0, r30, 0, 8, 8
/* 80090E7C 0008C39C  41 82 00 10 */	beq .L_80090E8C
/* 80090E80 0008C3A0  38 7F 01 0C */	addi r3, r31, 0x10c
/* 80090E84 0008C3A4  4C C6 31 82 */	crclr 6
/* 80090E88 0008C3A8  48 00 0A 25 */	bl OSReport
.L_80090E8C:
/* 80090E8C 0008C3AC  57 C0 02 53 */	rlwinm. r0, r30, 0, 9, 9
/* 80090E90 0008C3B0  41 82 00 10 */	beq .L_80090EA0
/* 80090E94 0008C3B4  38 7F 01 4C */	addi r3, r31, 0x14c
/* 80090E98 0008C3B8  4C C6 31 82 */	crclr 6
/* 80090E9C 0008C3BC  48 00 0A 11 */	bl OSReport
.L_80090EA0:
/* 80090EA0 0008C3C0  57 C0 02 95 */	rlwinm. r0, r30, 0, 0xa, 0xa
/* 80090EA4 0008C3C4  41 82 00 10 */	beq .L_80090EB4
/* 80090EA8 0008C3C8  38 7F 01 78 */	addi r3, r31, 0x178
/* 80090EAC 0008C3CC  4C C6 31 82 */	crclr 6
/* 80090EB0 0008C3D0  48 00 09 FD */	bl OSReport
.L_80090EB4:
/* 80090EB4 0008C3D4  57 C0 02 D7 */	rlwinm. r0, r30, 0, 0xb, 0xb
/* 80090EB8 0008C3D8  41 82 00 10 */	beq .L_80090EC8
/* 80090EBC 0008C3DC  38 7F 01 98 */	addi r3, r31, 0x198
/* 80090EC0 0008C3E0  4C C6 31 82 */	crclr 6
/* 80090EC4 0008C3E4  48 00 09 E9 */	bl OSReport
.L_80090EC8:
/* 80090EC8 0008C3E8  7F C3 F3 78 */	mr r3, r30
/* 80090ECC 0008C3EC  4B FF DB 8D */	bl PPCMthid2
/* 80090ED0 0008C3F0  80 01 00 84 */	lwz r0, 0x84(r1)
/* 80090ED4 0008C3F4  83 E1 00 7C */	lwz r31, 0x7c(r1)
/* 80090ED8 0008C3F8  83 C1 00 78 */	lwz r30, 0x78(r1)
/* 80090EDC 0008C3FC  83 A1 00 74 */	lwz r29, 0x74(r1)
/* 80090EE0 0008C400  7C 08 03 A6 */	mtlr r0
/* 80090EE4 0008C404  38 21 00 80 */	addi r1, r1, 0x80
/* 80090EE8 0008C408  4E 80 00 20 */	blr

glabel __OSCacheInit
/* 80090EEC 0008C40C  94 21 FF F0 */	stwu r1, -0x10(r1)
/* 80090EF0 0008C410  7C 08 02 A6 */	mflr r0
/* 80090EF4 0008C414  90 01 00 14 */	stw r0, 0x14(r1)
/* 80090EF8 0008C418  93 E1 00 0C */	stw r31, 0xc(r1)
/* 80090EFC 0008C41C  3F E0 80 18 */	lis r31, lbl_80182E08@ha
/* 80090F00 0008C420  3B FF 2E 08 */	addi r31, r31, lbl_80182E08@l
/* 80090F04 0008C424  93 C1 00 08 */	stw r30, 8(r1)
/* 80090F08 0008C428  4B FF DA 8D */	bl PPCMfhid0
/* 80090F0C 0008C42C  54 60 04 21 */	rlwinm. r0, r3, 0, 0x10, 0x10
/* 80090F10 0008C430  40 82 00 14 */	bne .L_80090F24
/* 80090F14 0008C434  4B FF FE 55 */	bl ICEnable
/* 80090F18 0008C438  38 7F 01 B4 */	addi r3, r31, 0x1b4
/* 80090F1C 0008C43C  4C C6 31 82 */	crclr 6
/* 80090F20 0008C440  48 00 D4 D1 */	bl DBPrintf
.L_80090F24:
/* 80090F24 0008C444  4B FF DA 71 */	bl PPCMfhid0
/* 80090F28 0008C448  54 60 04 63 */	rlwinm. r0, r3, 0, 0x11, 0x11
/* 80090F2C 0008C44C  40 82 00 14 */	bne .L_80090F40
/* 80090F30 0008C450  4B FF FC FD */	bl DCEnable
/* 80090F34 0008C454  38 7F 01 D0 */	addi r3, r31, 0x1d0
/* 80090F38 0008C458  4C C6 31 82 */	crclr 6
/* 80090F3C 0008C45C  48 00 D4 B5 */	bl DBPrintf
.L_80090F40:
/* 80090F40 0008C460  4B FF DA 65 */	bl PPCMfl2cr
/* 80090F44 0008C464  54 60 00 01 */	rlwinm. r0, r3, 0, 0, 0
/* 80090F48 0008C468  40 82 00 A8 */	bne .L_80090FF0
/* 80090F4C 0008C46C  4B FF DA 39 */	bl PPCMfmsr
/* 80090F50 0008C470  7C 7E 1B 78 */	mr r30, r3
/* 80090F54 0008C474  7C 00 04 AC */	sync 0
/* 80090F58 0008C478  38 60 00 30 */	li r3, 0x30
/* 80090F5C 0008C47C  4B FF DA 31 */	bl PPCMtmsr
/* 80090F60 0008C480  7C 00 04 AC */	sync 0
/* 80090F64 0008C484  7C 00 04 AC */	sync 0
/* 80090F68 0008C488  4B FF DA 3D */	bl PPCMfl2cr
/* 80090F6C 0008C48C  54 63 00 7E */	clrlwi r3, r3, 1
/* 80090F70 0008C490  4B FF DA 3D */	bl PPCMtl2cr
/* 80090F74 0008C494  7C 00 04 AC */	sync 0
/* 80090F78 0008C498  7C 00 04 AC */	sync 0
/* 80090F7C 0008C49C  4B FF DA 29 */	bl PPCMfl2cr
/* 80090F80 0008C4A0  54 63 00 7E */	clrlwi r3, r3, 1
/* 80090F84 0008C4A4  4B FF DA 29 */	bl PPCMtl2cr
/* 80090F88 0008C4A8  7C 00 04 AC */	sync 0
/* 80090F8C 0008C4AC  4B FF DA 19 */	bl PPCMfl2cr
/* 80090F90 0008C4B0  64 63 00 20 */	oris r3, r3, 0x20
/* 80090F94 0008C4B4  4B FF DA 19 */	bl PPCMtl2cr
.L_80090F98:
/* 80090F98 0008C4B8  4B FF DA 0D */	bl PPCMfl2cr
/* 80090F9C 0008C4BC  54 60 07 FF */	clrlwi. r0, r3, 0x1f
/* 80090FA0 0008C4C0  40 82 FF F8 */	bne .L_80090F98
/* 80090FA4 0008C4C4  4B FF DA 01 */	bl PPCMfl2cr
/* 80090FA8 0008C4C8  54 63 02 D2 */	rlwinm r3, r3, 0, 0xb, 9
/* 80090FAC 0008C4CC  4B FF DA 01 */	bl PPCMtl2cr
/* 80090FB0 0008C4D0  48 00 00 10 */	b .L_80090FC0
.L_80090FB4:
/* 80090FB4 0008C4D4  38 7F 00 00 */	addi r3, r31, 0
/* 80090FB8 0008C4D8  4C C6 31 82 */	crclr 6
/* 80090FBC 0008C4DC  48 00 D4 35 */	bl DBPrintf
.L_80090FC0:
/* 80090FC0 0008C4E0  4B FF D9 E5 */	bl PPCMfl2cr
/* 80090FC4 0008C4E4  54 60 07 FF */	clrlwi. r0, r3, 0x1f
/* 80090FC8 0008C4E8  40 82 FF EC */	bne .L_80090FB4
/* 80090FCC 0008C4EC  7F C3 F3 78 */	mr r3, r30
/* 80090FD0 0008C4F0  4B FF D9 BD */	bl PPCMtmsr
/* 80090FD4 0008C4F4  4B FF D9 D1 */	bl PPCMfl2cr
/* 80090FD8 0008C4F8  64 60 80 00 */	oris r0, r3, 0x8000
/* 80090FDC 0008C4FC  54 03 02 D2 */	rlwinm r3, r0, 0, 0xb, 9
/* 80090FE0 0008C500  4B FF D9 CD */	bl PPCMtl2cr
/* 80090FE4 0008C504  38 7F 01 EC */	addi r3, r31, 0x1ec
/* 80090FE8 0008C508  4C C6 31 82 */	crclr 6
/* 80090FEC 0008C50C  48 00 D4 05 */	bl DBPrintf
.L_80090FF0:
/* 80090FF0 0008C510  3C 80 80 09 */	lis r4, DMAErrorHandler@ha
/* 80090FF4 0008C514  38 60 00 01 */	li r3, 1
/* 80090FF8 0008C518  38 84 0D A4 */	addi r4, r4, DMAErrorHandler@l
/* 80090FFC 0008C51C  48 00 0A 6D */	bl OSSetErrorHandler
/* 80091000 0008C520  38 7F 02 04 */	addi r3, r31, 0x204
/* 80091004 0008C524  4C C6 31 82 */	crclr 6
/* 80091008 0008C528  48 00 D3 E9 */	bl DBPrintf
/* 8009100C 0008C52C  80 01 00 14 */	lwz r0, 0x14(r1)
/* 80091010 0008C530  83 E1 00 0C */	lwz r31, 0xc(r1)
/* 80091014 0008C534  83 C1 00 08 */	lwz r30, 8(r1)
/* 80091018 0008C538  7C 08 03 A6 */	mtlr r0
/* 8009101C 0008C53C  38 21 00 10 */	addi r1, r1, 0x10
/* 80091020 0008C540  4E 80 00 20 */	blr

